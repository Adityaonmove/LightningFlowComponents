<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Create_MS_Teams_Channel</name>
        <label>Create MS Teams Channel</label>
        <locationX>850</locationX>
        <locationY>984</locationY>
        <actionName>CreateMSTeamChannel</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Create_Message_Result_Screen</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Screen</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>description</name>
            <value>
                <elementReference>Channel_Description</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>displayName</name>
            <value>
                <elementReference>Channel_Name</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>membershipType</name>
            <value>
                <elementReference>Membership_Type</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>teamId</name>
            <value>
                <elementReference>MSTeamsList.value</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>token</name>
            <value>
                <elementReference>Access_Token</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <actionCalls>
        <name>Get_Channel_List</name>
        <label>Get Channel List</label>
        <locationX>576</locationX>
        <locationY>749</locationY>
        <actionName>GetMSTeams</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Message_To_Channel_Screen</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Screen</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>entityType</name>
            <value>
                <stringValue>channels</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>teamId</name>
            <value>
                <elementReference>MSTeamsList.value</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>token</name>
            <value>
                <elementReference>Access_Token</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>ChannelNameList</assignToReference>
            <name>labelList</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>ChannelIdList</assignToReference>
            <name>valueList</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Get_MS_Teams</name>
        <label>Get MS Teams</label>
        <locationX>966</locationX>
        <locationY>336</locationY>
        <actionName>GetMSTeams</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>MS_Teams_List_Screen</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Screen</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>entityType</name>
            <value>
                <stringValue>teams</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>token</name>
            <value>
                <elementReference>Access_Token</elementReference>
            </value>
        </inputParameters>
        <outputParameters>
            <assignToReference>MSTeamsNameList</assignToReference>
            <name>labelList</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>MSTeamsIdList</assignToReference>
            <name>valueList</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Post_Message_To_channel</name>
        <label>Post Message To channel</label>
        <locationX>563</locationX>
        <locationY>1206</locationY>
        <actionName>PostToMSTeams</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Result_Screen</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Error_Screen</targetReference>
        </faultConnector>
        <flowTransactionModel>Automatic</flowTransactionModel>
        <inputParameters>
            <name>body</name>
            <value>
                <elementReference>Body</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>channelId</name>
            <value>
                <elementReference>Channel.value</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>subject</name>
            <value>
                <elementReference>Subject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>teamId</name>
            <value>
                <elementReference>MSTeamsList.value</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>token</name>
            <value>
                <elementReference>Access_Token</elementReference>
            </value>
        </inputParameters>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>51.0</apiVersion>
    <choices>
        <name>CreateChannel</name>
        <choiceText>Create Channel</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>CreateChannel</stringValue>
        </value>
    </choices>
    <choices>
        <name>KickUser</name>
        <choiceText>Kick User</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>KickUser</stringValue>
        </value>
    </choices>
    <choices>
        <name>PostToChannel</name>
        <choiceText>Post To Channel</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>PostToChannel</stringValue>
        </value>
    </choices>
    <choices>
        <name>PrivateMembershipValue</name>
        <choiceText>Private</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>private</stringValue>
        </value>
    </choices>
    <choices>
        <name>StandardMembershipValue</name>
        <choiceText>Standard</choiceText>
        <dataType>String</dataType>
        <value>
            <stringValue>standard</stringValue>
        </value>
    </choices>
    <decisions>
        <name>Action_Decision</name>
        <label>Action Decision</label>
        <locationX>957</locationX>
        <locationY>754</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Post_To_Channel</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MS_Team_Actions</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>PostToChannel</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Channel_List</targetReference>
            </connector>
            <label>Post To Channel</label>
        </rules>
        <rules>
            <name>Create_Channel</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>MS_Team_Actions</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>CreateChannel</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Channel_Screen</targetReference>
            </connector>
            <label>Create Channel</label>
        </rules>
    </decisions>
    <interviewLabel>MS Teams Managment {!$Flow.CurrentDateTime}</interviewLabel>
    <label>MS Teams Managment</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>Flow</processType>
    <screens>
        <name>Autorization_Screen</name>
        <label>Autorization Screen</label>
        <locationX>965</locationX>
        <locationY>206</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_MS_Teams</targetReference>
        </connector>
        <fields>
            <name>Access_Token</name>
            <fieldText>Access Token</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Create_Channel_Screen</name>
        <label>Create Channel Screen</label>
        <locationX>855</locationX>
        <locationY>831</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Create_MS_Teams_Channel</targetReference>
        </connector>
        <fields>
            <name>Channel_Name</name>
            <dataType>String</dataType>
            <fieldText>Channel Name</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Channel_Description</name>
            <dataType>String</dataType>
            <fieldText>Channel Description</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Membership_Type</name>
            <choiceReferences>StandardMembershipValue</choiceReferences>
            <choiceReferences>PrivateMembershipValue</choiceReferences>
            <dataType>String</dataType>
            <fieldText>Membership Type</fieldText>
            <fieldType>DropdownBox</fieldType>
            <isRequired>true</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Create_Message_Result_Screen</name>
        <label>Create Message Result Screen</label>
        <locationX>845</locationX>
        <locationY>1258</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Get_MS_Teams</targetReference>
        </connector>
        <fields>
            <name>ChannelCreationResult</name>
            <fieldText>&lt;p&gt;Channel was created successfuly &lt;/p&gt;&lt;p&gt;Chanel id : {!Create_MS_Teams_Channel.channelId}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Error_Screen</name>
        <label>Error Screen</label>
        <locationX>50</locationX>
        <locationY>701</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <fields>
            <name>ErrorMessage</name>
            <fieldText>&lt;p&gt;{!$Flow.FaultMessage}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Message_To_Channel_Screen</name>
        <label>Message To Channel Screen</label>
        <locationX>572</locationX>
        <locationY>974</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Post_Message_To_channel</targetReference>
        </connector>
        <fields>
            <name>Channel</name>
            <extensionName>c:fsc_quickChoiceFSC</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>displayMode</name>
                <value>
                    <stringValue>Picklist</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>inputMode</name>
                <value>
                    <stringValue>Dual String Collections</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>choiceLabels</name>
                <value>
                    <elementReference>ChannelNameList</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>choiceValues</name>
                <value>
                    <elementReference>ChannelIdList</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>masterLabel</name>
                <value>
                    <stringValue>Choice channel</stringValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <fields>
            <name>Subject</name>
            <dataType>String</dataType>
            <fieldText>Subject</fieldText>
            <fieldType>InputField</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <fields>
            <name>Body</name>
            <fieldText>Body</fieldText>
            <fieldType>LargeTextArea</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>MS_Team_Actions_Screen</name>
        <label>MS Team Actions Screen</label>
        <locationX>966</locationX>
        <locationY>606</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>Action_Decision</targetReference>
        </connector>
        <fields>
            <name>MS_Team_Actions</name>
            <choiceReferences>KickUser</choiceReferences>
            <choiceReferences>PostToChannel</choiceReferences>
            <choiceReferences>CreateChannel</choiceReferences>
            <dataType>String</dataType>
            <fieldText>MS Team Actions</fieldText>
            <fieldType>RadioButtons</fieldType>
            <isRequired>false</isRequired>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>MS_Teams_List_Screen</name>
        <label>MS Teams List Screen</label>
        <locationX>971</locationX>
        <locationY>474</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>MS_Team_Actions_Screen</targetReference>
        </connector>
        <fields>
            <name>MSTeamsList</name>
            <extensionName>c:fsc_quickChoiceFSC</extensionName>
            <fieldType>ComponentInstance</fieldType>
            <inputParameters>
                <name>displayMode</name>
                <value>
                    <stringValue>Picklist</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>inputMode</name>
                <value>
                    <stringValue>Dual String Collections</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>choiceLabels</name>
                <value>
                    <elementReference>MSTeamsNameList</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>choiceValues</name>
                <value>
                    <elementReference>MSTeamsIdList</elementReference>
                </value>
            </inputParameters>
            <inputParameters>
                <name>masterLabel</name>
                <value>
                    <stringValue>MS Teams List</stringValue>
                </value>
            </inputParameters>
            <inputParameters>
                <name>required</name>
                <value>
                    <booleanValue>true</booleanValue>
                </value>
            </inputParameters>
            <inputsOnNextNavToAssocScrn>UseStoredValues</inputsOnNextNavToAssocScrn>
            <isRequired>true</isRequired>
            <storeOutputAutomatically>true</storeOutputAutomatically>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <screens>
        <name>Result_Screen</name>
        <label>Result Screen</label>
        <locationX>574</locationX>
        <locationY>1462</locationY>
        <allowBack>true</allowBack>
        <allowFinish>true</allowFinish>
        <allowPause>true</allowPause>
        <connector>
            <targetReference>MS_Team_Actions_Screen</targetReference>
        </connector>
        <fields>
            <name>Result</name>
            <fieldText>&lt;p&gt;success&lt;/p&gt;&lt;p&gt;message id :{!Post_Message_To_channel.messageId}&lt;/p&gt;</fieldText>
            <fieldType>DisplayText</fieldType>
        </fields>
        <showFooter>true</showFooter>
        <showHeader>true</showHeader>
    </screens>
    <start>
        <locationX>839</locationX>
        <locationY>48</locationY>
        <connector>
            <targetReference>Autorization_Screen</targetReference>
        </connector>
    </start>
    <status>Draft</status>
    <variables>
        <name>ChannelIdList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>ChannelNameList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>MSTeamsIdList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>MSTeamsNameList</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
</Flow>
