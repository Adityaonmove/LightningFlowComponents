<template>

    <!-- =============== Data Source Banner =============== -->
    <c-fsc_flow-banner 
        banner-color={bannerColor}  
        banner-label={sectionEntries.dataSource.label}
        banner-info={sectionEntries.dataSource.info}
        modal-header-color={modalHeaderColor}
    ></c-fsc_flow-banner>

    <!-- Select SObject -->
    <c-fsc_pick-object-and-field 
        if:true={isSObjectInput}
        field-label={inputValues.fieldName.label}
        object-label={inputValues.objectName.label} 
        object-type={selectedSObject}
        field={inputValues.fieldName.value} 
        onfieldselected={handleDynamicTypeMapping}
        hide-field-picklist=true>
    </c-fsc_pick-object-and-field>

    <!-- Data Source -->
    <c-fsc_flow-combobox 
        if:true={isObjectSelected}
        name="select_tableData" 
        label={inputValues.tableData.label}
        value={inputValues.tableData.value} 
        value-type={inputValues.tableData.valueDataType}
        builder-context-filter-type={selectedSObject}
        builder-context-filter-collection-boolean={inputValues.tableData.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <c-fsc_flow-combobox 
        if:false={isSObjectInput}
        name="select_tableDataString" 
        label={inputValues.tableDataString.label}
        value={inputValues.tableDataString.value} 
        value-type={inputValues.tableDataString.valueDataType}
        builder-context-filter-collection-boolean={inputValues.tableDataString.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <!-- Pre-Selected Rows -->
    <c-fsc_flow-combobox 
        if:true={isObjectSelected}
        name="select_preSelectedRows" 
        label={inputValues.preSelectedRows.label}
        value={inputValues.preSelectedRows.value} 
        value-type={inputValues.preSelectedRows.valueDataType}
        builder-context-filter-type={selectedSObject}
        builder-context-filter-collection-boolean={inputValues.preSelectedRows.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <c-fsc_flow-combobox 
        if:false={isSObjectInput}
        name="select_preSelectedRowsString" 
        label={inputValues.preSelectedRowsString.label}
        value={inputValues.preSelectedRowsString.value} 
        value-type={inputValues.preSelectedRowsString.valueDataType}
        builder-context-filter-collection-boolean={inputValues.preSelectedRowsString.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <!-- =============== Column Wizard Banner =============== -->
    <c-fsc_flow-banner
        banner-color={colorWizardOverride}  
        banner-label={sectionEntries.columnWizard.label}
        banner-info={sectionEntries.columnWizard.info}
        modal-header-color={modalHeaderColorWizardOverride}
    ></c-fsc_flow-banner>
    
    <!-- Column Wizard -->
    <div if:true={isObjectSelected}> 

        <div class="slds-box slds-theme_shade slds-m-top_small">
            <div align="center">
                <lightning-button label="Load Column Wizard" icon-name="utility:lightning_extension" onclick={showModal}></lightning-button>
            </div>
        </div>

        <template if:true={openModal}>
            <div class="slds-modal slds-modal_large slds-fade-in-open slds-backdrop">
                <div class="slds-modal__container">

                    <!-- Header Section -->
                    <div class="slds-modal__header">
                        <lightning-button-icon icon-name="utility:close"
                            alternative-text="Close this window" size="large" variant="bare-inverse"
                            onclick={closeModal} class="slds-modal__close">
                        </lightning-button-icon>
                        <h2 class="slds-modal__title slds-hyphenate">Welcome To The Datatable Column Wizard</h2>
                    </div>

                    <!-- Body Section -->
                    <div class="slds-modal__content slds-p-around_medium">
                        <c-screen-flow width="100%" height={wizardHeight}
                            flow-name="Datatable_Configuration_Wizard" name="uniqueName"
                            flow-params={wizardParams}
                            onflowstatuschange={handleFlowStatusChange}>
                        </c-screen-flow>
                    </div>

                    <!-- Footer Section -->
                    <div class="slds-modal__footer slds-modal__footer_directional">
                        <lightning-button label="Cancel Wizard" variant="neutral"
                            icon-name="utility:close" 
                            onclick={closeModal}>
                        </lightning-button>
                        <lightning-slider value={wizardHeight} label="Wizard Height (pixels)"
                            min="400" 
                            max="1000" 
                            step="10"
                            onchange={handleHeightChange}>
                        </lightning-slider>
                    </div>

                </div>
            </div>
        </template>

    </div>

    <!-- =============== Table Formatting Banner =============== -->
    <c-fsc_flow-banner
        banner-color={bannerColor}  
        banner-label={sectionEntries.tableFormatting.label}
        banner-info={sectionEntries.tableFormatting.info}
        modal-header-color={modalHeaderColor}
    ></c-fsc_flow-banner>

    <!-- Table Header -->
    <c-fsc_flow-combobox 
        name="select_tableLabel" 
        label={inputValues.tableLabel.label}
        value={inputValues.tableLabel.value} 
        value-type={inputValues.tableLabel.valueDataType}
        builder-context-filter-collection-boolean={inputValues.tableLabel.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>
    <c-fsc_flow-combobox 
        name="select_tableIcon" 
        label={inputValues.tableIcon.label}
        value={inputValues.tableIcon.value} 
        value-type={inputValues.tableIcon.valueDataType}
        field-level-help={inputValues.tableIcon.helpText}
        builder-context-filter-collection-boolean={inputValues.tableIcon.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <!-- Other Table Formatting -->
    <lightning-input class="slds-m-vertical_xx-small"
        type="checkbox" 
        label={inputValues.tableBorder.label} 
        name="select_tableBorder"
        checked={inputValues.tableBorder.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>
    <c-fsc_flow-combobox 
        name="select_tableHeight" 
        label={inputValues.tableHeight.label}
        value={inputValues.tableHeight.value} 
        value-type={inputValues.tableHeight.valueDataType}
        field-level-help={inputValues.tableHeight.helpText}
        builder-context-filter-collection-boolean={inputValues.tableHeight.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>
    <c-fsc_flow-combobox 
        name="select_maxNumberOfRows" 
        label={inputValues.maxNumberOfRows.label}
        value={inputValues.maxNumberOfRows.value} 
        value-type={inputValues.maxNumberOfRows.valueDataType}
        field-level-help={inputValues.maxNumberOfRows.helpText}
        builder-context-filter-collection-boolean={inputValues.maxNumberOfRows.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

    <!-- =============== Table Behavior Banner =============== -->
    <c-fsc_flow-banner
        banner-label={sectionEntries.tableBehavior.label}
        banner-info={sectionEntries.tableBehavior.info}
    ></c-fsc_flow-banner>

    <!-- Table Behavior Options -->
    <lightning-input class="slds-m-vertical_xx-small"
        type="checkbox" 
        label={inputValues.suppressNameFieldLink.label} 
        name="select_suppressNameFieldLink"
        checked={inputValues.suppressNameFieldLink.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>
    <lightning-input class="slds-m-vertical_xx-small"
        if:true={isHideCheckboxColumn}
        type="checkbox" 
        label={inputValues.hideCheckboxColumn.label} 
        name="select_hideCheckboxColumn"
        checked={inputValues.hideCheckboxColumn.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>
    <lightning-input class="slds-m-vertical_xx-small"
        if:false={isCheckboxColumnHidden}
        type="checkbox" 
        label={inputValues.isRequired.label} 
        name="select_isRequired"
        checked={inputValues.isRequired.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>
    <lightning-input class="slds-m-vertical_xx-small"
        if:false={isCheckboxColumnHidden}
        type="checkbox" 
        label={inputValues.singleRowSelection.label} 
        name="select_singleRowSelection"
        checked={inputValues.singleRowSelection.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>   

    <!-- =============== Advanced Attributes Banner =============== -->
    <c-fsc_flow-banner
        banner-color={colorAdvancedOverride}
        banner-label={sectionEntries.advancedAttributes.label}
        banner-info={sectionEntries.advancedAttributes.info}
        modal-header-color={modalHeaderColorAdvancedOverride}
    ></c-fsc_flow-banner>

    <!-- Apex Defined Object? -->
    <lightning-input class="slds-m-vertical_xx-small"
        type="checkbox" 
        label={inputValues.isUserDefinedObject.label} 
        name="select_isUserDefinedObject"
        checked={inputValues.isUserDefinedObject.value} 
        onblur={handleValueChange}
        onchange={handleValueChange}>
    </lightning-input>

    <!-- Key Field -->
    <c-fsc_flow-combobox 
        name="select_keyField" 
        label={inputValues.keyField.label}
        value={inputValues.keyField.value} 
        value-type={inputValues.keyField.valueDataType}
        field-level-help={inputValues.keyField.helpText}
        builder-context-filter-collection-boolean={inputValues.keyField.isCollection}
        builder-context={_builderContext} 
        onvaluechanged={handleFlowComboboxValueChange}>
    </c-fsc_flow-combobox>

</template>